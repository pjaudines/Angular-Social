webpackJsonp([0],{Dvgu:function(e,t,n){e.exports=n("tYwN")},OzfH:function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function i(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,o,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function a(e){e.INTERNAL.registerService("messaging",function(e){return self&&"ServiceWorkerGlobalScope"in self?new D(e):new O(e)},{Messaging:O})}Object.defineProperty(t,"__esModule",{value:!0});var s,u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},c=(Object,n("JEJ4")),l={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},p={codes:l,map:(s={},s[l.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",s[l.AVAILABLE_IN_SW]="This method is available in a service worker context.",s[l.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",s[l.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",s[l.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",s[l.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",s[l.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",s[l.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",s[l.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",s[l.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",s[l.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",s[l.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",s[l.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",s[l.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",s[l.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",s[l.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",s[l.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",s[l.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",s[l.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",s[l.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",s[l.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",s[l.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",s[l.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",s[l.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",s[l.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",s[l.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",s[l.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",s[l.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",s[l.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",s[l.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",s[l.BAD_SCOPE]="The service worker scope must be a string with at least one character.",s[l.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",s[l.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",s[l.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",s[l.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",s[l.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",s[l.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",s[l.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",s)},h=function(){function e(e,t){this.errorFactory_=new c.ErrorFactory("messaging","Messaging",p.map),this.DB_NAME_=e,this.dbVersion_=t,this.openDbPromise_=null,this.TRANSACTION_READ_WRITE="readwrite"}return e.prototype.openDatabase=function(){var e=this;return this.openDbPromise_?this.openDbPromise_:(this.openDbPromise_=new Promise(function(t,n){var r=indexedDB.open(e.DB_NAME_,e.dbVersion_);r.onerror=function(e){n(e.target.error)},r.onsuccess=function(e){t(e.target.result)},r.onupgradeneeded=function(t){try{var r=t.target.result;e.onDBUpgrade(r,t)}catch(e){r.close(),n(e)}}}),this.openDbPromise_)},e.prototype.closeDatabase=function(){var e=this;return Promise.resolve().then(function(){if(e.openDbPromise_)return e.openDbPromise_.then(function(t){t.close(),e.openDbPromise_=null})})},e.prototype.onDBUpgrade=function(e,t){throw this.errorFactory_.create(p.codes.SHOULD_BE_INHERITED)},e}(),_=function(e){return function(e){var t=new Uint8Array(e);return window.btoa(String.fromCharCode.apply(null,t))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},f=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),d={DEFAULT_PUBLIC_VAPID_KEY:f,SUBSCRIPTION_DETAILS:{userVisibleOnly:!0,applicationServerKey:f},ENDPOINT:"https://fcm.googleapis.com"},g=function(){function e(){this.errorFactory_=new c.ErrorFactory("messaging","Messaging",p.map)}return e.prototype.getToken=function(e,t,n){var r=this,o=_(t.getKey("p256dh")),i=_(t.getKey("auth")),a="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+o+"&encryption_auth="+i;n!==d.DEFAULT_PUBLIC_VAPID_KEY&&(a+="&application_pub_key="+_(n));var s=new Headers;s.append("Content-Type","application/x-www-form-urlencoded");var u={method:"POST",headers:s,body:a};return fetch(d.ENDPOINT+"/fcm/connect/subscribe",u).then(function(e){return e.json()}).catch(function(){throw r.errorFactory_.create(p.codes.TOKEN_SUBSCRIBE_FAILED)}).then(function(e){var t=e;if(t.error)throw r.errorFactory_.create(p.codes.TOKEN_SUBSCRIBE_FAILED,{message:t.error.message});if(!t.token)throw r.errorFactory_.create(p.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!t.pushSet)throw r.errorFactory_.create(p.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:t.token,pushSet:t.pushSet}})},e.prototype.updateToken=function(e,t,n,r,o){var i=this,a=_(r.getKey("p256dh")),s=_(r.getKey("auth")),u="push_set="+n+"&token="+t+"&authorized_entity="+e+"&endpoint="+r.endpoint+"&encryption_key="+a+"&encryption_auth="+s;o!==d.DEFAULT_PUBLIC_VAPID_KEY&&(u+="&application_pub_key="+_(o));var c=new Headers;c.append("Content-Type","application/x-www-form-urlencoded");var l,h={method:"POST",headers:c,body:u};return fetch(d.ENDPOINT+"/fcm/connect/subscribe",h).then(function(e){return l=e,e.json()}).catch(function(){throw i.errorFactory_.create(p.codes.TOKEN_UPDATE_FAILED)}).then(function(e){if(!l.ok)throw i.errorFactory_.create(p.codes.TOKEN_UPDATE_FAILED,{message:e.error.message});if(!e.token)throw i.errorFactory_.create(p.codes.TOKEN_UPDATE_NO_TOKEN);return e.token})},e.prototype.deleteToken=function(e,t,n){var r=this,o="authorized_entity="+e+"&token="+t+"&pushSet="+n,i=new Headers;i.append("Content-Type","application/x-www-form-urlencoded");var a={method:"POST",headers:i,body:o};return fetch(d.ENDPOINT+"/fcm/connect/unsubscribe",a).then(function(e){if(!e.ok)return e.json().then(function(e){if(e.error)throw r.errorFactory_.create(p.codes.TOKEN_UNSUBSCRIBE_FAILED,{message:e.error.message})},function(e){throw r.errorFactory_.create(p.codes.TOKEN_UNSUBSCRIBE_FAILED)})})},e}(),E="fcm_token_details_db",b=2,m=function(e){function t(){return e.call(this,E,b)||this}return r(t,e),t.prototype.onDBUpgrade=function(e,t){if(t.oldVersion<1){var n=e.createObjectStore("fcm_token_object_Store",{keyPath:"swScope"});n.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),n.createIndex("fcmToken","fcmToken",{unique:!0})}t.oldVersion<2&&function(){var e=indexedDB.open("undefined");e.onerror=function(e){},e.onsuccess=function(t){!function(e){if(e.objectStoreNames.contains("fcm_token_object_Store")){var t=e.transaction("fcm_token_object_Store").objectStore("fcm_token_object_Store"),n=new g,r=t.openCursor();r.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},r.onsuccess=function(){var t=r.result;if(t){var o=t.value;n.deleteToken(o.fcmSenderId,o.fcmToken,o.fcmPushSet),t.continue()}else e.close(),indexedDB.deleteDatabase("undefined")}}}(e.result)}}()},t.prototype.validateInputs_=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return!e.fcmToken||"string"==typeof e.fcmToken&&0!==e.fcmToken.length?!e.swScope||"string"==typeof e.swScope&&0!==e.swScope.length?!e.vapidKey||e.vapidKey instanceof Uint8Array&&65===e.vapidKey.length?!e.subscription||e.subscription instanceof PushSubscription?!e.fcmSenderId||"string"==typeof e.fcmSenderId&&0!==e.fcmSenderId.length?!e.fcmPushSet||"string"==typeof e.fcmPushSet&&0!==e.fcmPushSet.length?[2]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_PUSH_SET))]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_SENDER_ID))]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_SUBSCRIPTION))]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_VAPID_KEY))]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_SCOPE))]:[2,Promise.reject(this.errorFactory_.create(p.codes.BAD_TOKEN))]})})},t.prototype.getTokenDetailsFromToken=function(e){var t=this;return e?this.validateInputs_({fcmToken:e}).then(function(){return t.openDatabase()}).then(function(t){return new Promise(function(n,r){var o=t.transaction(["fcm_token_object_Store"]).objectStore("fcm_token_object_Store").index("fcmToken").get(e);o.onerror=function(e){r(e.target.error)},o.onsuccess=function(e){n(e.target.result?e.target.result:null)}})}):Promise.reject(this.errorFactory_.create(p.codes.BAD_TOKEN))},t.prototype.getTokenDetailsFromSWScope=function(e){var t=this;return e?this.validateInputs_({swScope:e}).then(function(){return t.openDatabase()}).then(function(t){return new Promise(function(n,r){var o=t.transaction(["fcm_token_object_Store"]).objectStore("fcm_token_object_Store").get(e);o.onerror=function(e){r(e.target.error)},o.onsuccess=function(e){n(e.target.result?e.target.result:null)}})}):Promise.reject(this.errorFactory_.create(p.codes.BAD_SCOPE))},t.prototype.saveTokenDetails=function(e){var t=this,n=e.swScope,r=e.vapidKey,o=e.subscription,i=e.fcmSenderId,a=e.fcmToken,s=e.fcmPushSet;return n?r?o?i?a?s?this.validateInputs_({swScope:n,vapidKey:r,subscription:o,fcmSenderId:i,fcmToken:a,fcmPushSet:s}).then(function(){return t.openDatabase()}).then(function(e){var u={swScope:n,vapidKey:_(r),endpoint:o.endpoint,auth:_(o.getKey("auth")),p256dh:_(o.getKey("p256dh")),fcmSenderId:i,fcmToken:a,fcmPushSet:s,createTime:Date.now()};return new Promise(function(n,r){var o=e.transaction(["fcm_token_object_Store"],t.TRANSACTION_READ_WRITE).objectStore("fcm_token_object_Store").put(u);o.onerror=function(e){r(e.target.error)},o.onsuccess=function(e){n()}})}):Promise.reject(this.errorFactory_.create(p.codes.BAD_PUSH_SET)):Promise.reject(this.errorFactory_.create(p.codes.BAD_TOKEN)):Promise.reject(this.errorFactory_.create(p.codes.BAD_SENDER_ID)):Promise.reject(this.errorFactory_.create(p.codes.BAD_SUBSCRIPTION)):Promise.reject(this.errorFactory_.create(p.codes.BAD_VAPID_KEY)):Promise.reject(this.errorFactory_.create(p.codes.BAD_SCOPE))},t.prototype.deleteToken=function(e){var t=this;return"string"!=typeof e||0===e.length?Promise.reject(this.errorFactory_.create(p.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(e).then(function(e){if(!e)throw t.errorFactory_.create(p.codes.DELETE_TOKEN_NOT_FOUND);return t.openDatabase().then(function(n){return new Promise(function(r,o){var i=n.transaction(["fcm_token_object_Store"],t.TRANSACTION_READ_WRITE).objectStore("fcm_token_object_Store").delete(e.swScope);i.onerror=function(e){o(e.target.error)},i.onsuccess=function(n){0!==n.target.result?r(e):o(t.errorFactory_.create(p.codes.FAILED_TO_DELETE_TOKEN))}})})})},t}(h),y="fcm_vapid_details_db",v=1,T=function(e){function t(){return e.call(this,y,v)||this}return r(t,e),t.prototype.onDBUpgrade=function(e){e.createObjectStore("fcm_vapid_object_Store",{keyPath:"swScope"})},t.prototype.getVapidFromSWScope=function(e){return"string"!=typeof e||0===e.length?Promise.reject(this.errorFactory_.create(p.codes.BAD_SCOPE)):this.openDatabase().then(function(t){return new Promise(function(n,r){var o=t.transaction(["fcm_vapid_object_Store"]).objectStore("fcm_vapid_object_Store").get(e);o.onerror=function(){r(o.error)},o.onsuccess=function(){var e=o.result,t=null;e&&(t=e.vapidKey),n(t)}})})},t.prototype.saveVapidDetails=function(e,t){var n=this;if("string"!=typeof e||0===e.length)return Promise.reject(this.errorFactory_.create(p.codes.BAD_SCOPE));if(null===t||65!==t.length)return Promise.reject(this.errorFactory_.create(p.codes.BAD_VAPID_KEY));var r={swScope:e,vapidKey:t};return this.openDatabase().then(function(e){return new Promise(function(t,o){var i=e.transaction(["fcm_vapid_object_Store"],n.TRANSACTION_READ_WRITE).objectStore("fcm_vapid_object_Store").put(r);i.onerror=function(){o(i.error)},i.onsuccess=function(){t()}})})},t.prototype.deleteVapidDetails=function(e){var t=this;return this.getVapidFromSWScope(e).then(function(n){if(!n)throw t.errorFactory_.create(p.codes.DELETE_SCOPE_NOT_FOUND);return t.openDatabase().then(function(r){return new Promise(function(o,i){var a=r.transaction(["fcm_vapid_object_Store"],t.TRANSACTION_READ_WRITE).objectStore("fcm_vapid_object_Store").delete(e);a.onerror=function(){i(a.error)},a.onsuccess=function(){0!==a.result?o(n):i(t.errorFactory_.create(p.codes.FAILED_DELETE_VAPID_KEY))}})})})},t}(h),S={granted:"granted",default:"default",denied:"denied"},N="messagingSenderId",R=function(){function e(e){var t=this;if(this.errorFactory_=new c.ErrorFactory("messaging","Messaging",p.map),!e.options[N]||"string"!=typeof e.options[N])throw this.errorFactory_.create(p.codes.BAD_SENDER_ID);this.messagingSenderId_=e.options[N],this.tokenDetailsModel_=new m,this.vapidDetailsModel_=new T,this.iidModel_=new g,this.app=e,this.INTERNAL={},this.INTERNAL.delete=function(){return t.delete()}}return e.prototype.getToken=function(){var e=this,t=this.getNotificationPermission_();if(t!==S.granted)return t===S.denied?Promise.reject(this.errorFactory_.create(p.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null);var n;return this.getSWRegistration_().then(function(t){return n=t,e.tokenDetailsModel_.getTokenDetailsFromSWScope(n.scope)}).then(function(t){return t?e.manageExistingToken(t,n):e.getNewToken(n)})},e.prototype.manageExistingToken=function(e,t){var n=this;return this.isTokenStillValid(e).then(function(r){return r?Date.now()<e.createTime+6048e5?e.fcmToken:n.updateToken(e,t):n.deleteToken(e.fcmToken).then(function(){return n.getNewToken(t)})})},e.prototype.isTokenStillValid=function(e){return this.getPublicVapidKey_().then(function(t){return _(t)===e.vapidKey})},e.prototype.updateToken=function(e,t){var n,r,o,i=this;return this.getPublicVapidKey_().then(function(e){return n=e,i.getPushSubscription_(t,n)}).then(function(t){return o=t,i.iidModel_.updateToken(i.messagingSenderId_,e.fcmToken,e.fcmPushSet,o,n)}).catch(function(t){return i.deleteToken(e.fcmToken).then(function(){throw t})}).then(function(a){return i.tokenDetailsModel_.saveTokenDetails({swScope:t.scope,vapidKey:n,subscription:o,fcmSenderId:i.messagingSenderId_,fcmToken:r=a,fcmPushSet:e.fcmPushSet})}).then(function(){return i.vapidDetailsModel_.saveVapidDetails(t.scope,n)}).then(function(){return r})},e.prototype.getNewToken=function(e){var t,n,r,o=this;return this.getPublicVapidKey_().then(function(n){return t=n,o.getPushSubscription_(e,t)}).then(function(e){return n=e,o.iidModel_.getToken(o.messagingSenderId_,n,t)}).then(function(i){return o.tokenDetailsModel_.saveTokenDetails({swScope:e.scope,vapidKey:t,subscription:n,fcmSenderId:o.messagingSenderId_,fcmToken:(r=i).token,fcmPushSet:r.pushSet})}).then(function(){return o.vapidDetailsModel_.saveVapidDetails(e.scope,t)}).then(function(){return r.token})},e.prototype.deleteToken=function(e){var t=this;return this.tokenDetailsModel_.deleteToken(e).then(function(e){return t.iidModel_.deleteToken(e.fcmSenderId,e.fcmToken,e.fcmPushSet)}).then(function(){return t.getSWRegistration_().then(function(e){if(e)return e.pushManager.getSubscription()}).then(function(e){if(e)return e.unsubscribe()})})},e.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(p.codes.SHOULD_BE_INHERITED)},e.prototype.getPublicVapidKey_=function(){throw this.errorFactory_.create(p.codes.SHOULD_BE_INHERITED)},e.prototype.requestPermission=function(){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.getPushSubscription_=function(e,t){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.usePublicVapidKey=function(e){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,n){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,n){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw this.errorFactory_.create(p.codes.AVAILABLE_IN_SW)},e.prototype.delete=function(){return Promise.all([this.tokenDetailsModel_.closeDatabase(),this.vapidDetailsModel_.closeDatabase()])},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel_},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel_},e.prototype.getIIDModel=function(){return this.iidModel_},e}(),w={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},I={PARAMS:w,TYPES_OF_MSG:{PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},createNewMsg:function(e,t){return n={},n[w.TYPE_OF_MSG]=e,n[w.DATA]=t,n;var n}},A={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"},O=function(e){function t(t){var n=e.call(this,t)||this;return n.messageObserver_=null,n.onMessage_=Object(c.createSubscribe)(function(e){n.messageObserver_=e}),n.tokenRefreshObserver_=null,n.onTokenRefresh_=Object(c.createSubscribe)(function(e){n.tokenRefreshObserver_=e}),n.messageObserver_=null,n.onMessage_=Object(c.createSubscribe)(function(e){n.messageObserver_=e}),n.tokenRefreshObserver_=null,n.onTokenRefresh_=Object(c.createSubscribe)(function(e){n.tokenRefreshObserver_=e}),n.setupSWMessageListener_(),n}return r(t,e),t.prototype.getToken=function(){var t=this;return this.isSupported_()?this.manifestCheck_().then(function(){return e.prototype.getToken.call(t)}):Promise.reject(this.errorFactory_.create(p.codes.UNSUPPORTED_BROWSER))},t.prototype.manifestCheck_=function(){var e=this;if(this.manifestCheckPromise_)return this.manifestCheckPromise_;var t=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise_=t?fetch(t.href).then(function(e){return e.json()}).catch(function(){}).then(function(t){if(t&&t.gcm_sender_id&&"103953800507"!==t.gcm_sender_id)throw e.errorFactory_.create(p.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise_},t.prototype.requestPermission=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(t){return Notification.permission===S.granted?[2]:[2,new Promise(function(t,n){var r=function(r){return r===S.granted?t():n(e.errorFactory_.create(r===S.denied?p.codes.PERMISSION_BLOCKED:p.codes.PERMISSION_DEFAULT))},o=Notification.requestPermission(r);o&&o.then(r)})]})})},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw this.errorFactory_.create(p.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.registrationToUse_)throw this.errorFactory_.create(p.codes.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse_=e},t.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw this.errorFactory_.create(p.codes.INVALID_PUBLIC_VAPID_KEY);if(void 0!==this.publicVapidKeyToUse_)throw this.errorFactory_.create(p.codes.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var t=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}(e);if(65!==t.length)throw this.errorFactory_.create(p.codes.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse_=t},t.prototype.onMessage=function(e,t,n){return this.onMessage_(e,t,n)},t.prototype.onTokenRefresh=function(e,t,n){return this.onTokenRefresh_(e,t,n)},t.prototype.waitForRegistrationToActivate_=function(e){var t=this,n=e.installing||e.waiting||e.active;return new Promise(function(r,o){if(n)if("activated"!==n.state)if("redundant"!==n.state){var i=function(){if("activated"===n.state)r(e);else{if("redundant"!==n.state)return;o(t.errorFactory_.create(p.codes.SW_REG_REDUNDANT))}n.removeEventListener("statechange",i)};n.addEventListener("statechange",i)}else o(t.errorFactory_.create(p.codes.SW_REG_REDUNDANT));else r(e);else o(t.errorFactory_.create(p.codes.NO_SW_IN_REG))})},t.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse_?this.waitForRegistrationToActivate_(this.registrationToUse_):(this.registrationToUse_=null,navigator.serviceWorker.register(A.path,{scope:A.scope}).catch(function(t){throw e.errorFactory_.create(p.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(t){return e.waitForRegistrationToActivate_(t).then(function(){return e.registrationToUse_=t,t.update(),t})}))},t.prototype.getPublicVapidKey_=function(){return this.publicVapidKeyToUse_?Promise.resolve(this.publicVapidKeyToUse_):Promise.resolve(d.DEFAULT_PUBLIC_VAPID_KEY)},t.prototype.getPushSubscription_=function(e,t){return e.pushManager.getSubscription().then(function(n){return n||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})})},t.prototype.setupSWMessageListener_=function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[I.PARAMS.TYPE_OF_MSG]){var n=t.data;switch(n[I.PARAMS.TYPE_OF_MSG]){case I.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case I.TYPES_OF_MSG.NOTIFICATION_CLICKED:e.messageObserver_&&e.messageObserver_.next(n[I.PARAMS.DATA])}}},!1)},t.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},t}(R),D=function(e){function t(t){var n=e.call(this,t)||this;return self.addEventListener("push",function(e){return n.onPush_(e)},!1),self.addEventListener("pushsubscriptionchange",function(e){return n.onSubChange_(e)},!1),self.addEventListener("notificationclick",function(e){return n.onNotificationClick_(e)},!1),n.bgMessageHandler_=null,n}return r(t,e),t.prototype.onPush_=function(e){var t,n=this;try{t=e.data.json()}catch(e){return}var r=this.hasVisibleClients_().then(function(e){if(e){if(t.notification||n.bgMessageHandler_)return n.sendMessageToWindowClients_(t)}else{var r=n.getNotificationData_(t);if(r){var o=r.title||"";return n.getSWRegistration_().then(function(e){return e.showNotification(o,r)})}if(n.bgMessageHandler_)return n.bgMessageHandler_(t)}});e.waitUntil(r)},t.prototype.onSubChange_=function(e){var t=this,n=this.getSWRegistration_().then(function(e){return e.pushManager.getSubscription().then(function(e){}).catch(function(n){return t.getTokenDetailsModel().getTokenDetailsFromSWScope(e.scope).then(function(e){if(!e)throw n;return t.deleteToken(e.fcmToken).then(function(){throw n})})})}).catch(function(e){throw t.errorFactory_.create(p.codes.UNABLE_TO_RESUBSCRIBE,{message:e})});e.waitUntil(n)},t.prototype.onNotificationClick_=function(e){var t=this;if(e.notification&&e.notification.data&&e.notification.data.FCM_MSG){e.stopImmediatePropagation(),e.notification.close();var n=e.notification.data.FCM_MSG;if(n.notification){var r=n.notification.click_action;if(r){var o=this.getWindowClient_(r).then(function(e){return e?e.focus():self.clients.openWindow(r)}).then(function(e){if(e){delete n.notification;var r=I.createNewMsg(I.TYPES_OF_MSG.NOTIFICATION_CLICKED,n);return t.attemptToMessageClient_(e,r)}});e.waitUntil(o)}}}},t.prototype.getNotificationData_=function(e){if(e&&"object"==typeof e.notification){var t=Object.assign({},e.notification);return t.data=(n={},n.FCM_MSG=e,n),t;var n}},t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw this.errorFactory_.create(p.codes.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler_=e},t.prototype.getWindowClient_=function(e){var t=new URL(e,self.location).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){for(var n=null,r=0;r<e.length;r++)if(new URL(e[r].url,self.location).href===t){n=e[r];break}return n||null})},t.prototype.attemptToMessageClient_=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(n){return e?(e.postMessage(t),[2]):[2,Promise.reject(this.errorFactory_.create(p.codes.NO_WINDOW_CLIENT_TO_MSG))]})})},t.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){return e.some(function(e){return"visible"===e.visibilityState})})},t.prototype.sendMessageToWindowClients_=function(e){var t=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){var r=I.createNewMsg(I.TYPES_OF_MSG.PUSH_MSG_RECEIVED,e);return Promise.all(n.map(function(e){return t.attemptToMessageClient_(e,r)}))})},t.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)},t.prototype.getPublicVapidKey_=function(){var e=this;return this.getSWRegistration_().then(function(t){return e.getVapidDetailsModel().getVapidFromSWScope(t.scope)}).then(function(e){return null===e?d.DEFAULT_PUBLIC_VAPID_KEY:e})},t}(R),U=n("XtH8");t.registerMessaging=a,a(U.firebase)},Rv9P:function(e,t,n){n("TL6u")},Y5DG:function(e,t,n){n("OzfH")},"ce4+":function(e,t,n){n("usOC")},iEW0:function(e,t,n){var r=n("kUdC");n("Rv9P"),n("Dvgu"),n("Y5DG"),n("ce4+"),e.exports=r},sCQa:function(e,t,n){"use strict";function r(e){return c._24(0,[(e()(),c._3(0,0,null,null,1,"strong",[],null,null,null,null,null)),(e()(),c._22(1,null,["",""])),(e()(),c._22(-1,null,["\n"])),(e()(),c._3(3,0,null,null,1,"button",[["class","button is-danger is-small"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.deleteUpload()&&r),r},null,null)),(e()(),c._22(-1,null,["Delete"])),(e()(),c._3(5,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n"]))],null,function(e,t){e(t,1,0,t.component.upload.name)})}function o(e){return c._24(0,[(e()(),c._3(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n  "])),(e()(),c._3(2,0,null,null,0,"progress",[["class","progress is-success"],["max","100"],["min","1"]],[[8,"value",0]],null,null,null,null)),(e()(),c._22(3,null,["\n  Progress: "," | ","% Complete\n"]))],null,function(e,t){var n=t.component;e(t,2,0,c._6(1,"",null==n.currentUpload?null:n.currentUpload.progress,"")),e(t,3,0,null==n.currentUpload?null:n.currentUpload.name,null==n.currentUpload?null:n.currentUpload.progress)})}function i(e){return c._24(0,[(e()(),c.Y(16777216,null,null,1,null,o)),c._2(1,16384,null,0,m.l,[c.M,c.J],{ngIf:[0,"ngIf"]},null),(e()(),c._22(-1,null,["\n\n\n"])),(e()(),c._3(3,0,null,null,25,"div",[["class","box"]],null,null,null,null,null)),(e()(),c._22(-1,null,["\n  "])),(e()(),c._3(5,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),c._22(-1,null,["Single File Upload"])),(e()(),c._22(-1,null,["\n\n  "])),(e()(),c._3(8,0,null,null,3,"label",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n    "])),(e()(),c._3(10,0,null,null,0,"input",[["class","button"],["type","file"]],null,[[null,"change"]],function(e,t,n){var r=!0;return"change"===t&&(r=!1!==e.component.detectFiles(n)&&r),r},null,null)),(e()(),c._22(-1,null,["\n  "])),(e()(),c._22(-1,null,["\n  "])),(e()(),c._3(13,0,null,null,1,"button",[["class","button is-primary"]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.uploadSingle()&&r),r},null,null)),(e()(),c._22(-1,null,["\n    Upload Single\n  "])),(e()(),c._22(-1,null,["\n\n  "])),(e()(),c._3(16,0,null,null,0,"hr",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n\n  "])),(e()(),c._3(18,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),c._22(-1,null,["Multiple File Upload"])),(e()(),c._22(-1,null,["\n\n  "])),(e()(),c._3(21,0,null,null,3,"label",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n    "])),(e()(),c._3(23,0,null,null,0,"input",[["class","button"],["multiple",""],["type","file"]],null,[[null,"change"]],function(e,t,n){var r=!0;return"change"===t&&(r=!1!==e.component.detectFiles(n)&&r),r},null,null)),(e()(),c._22(-1,null,["\n  "])),(e()(),c._22(-1,null,["\n  "])),(e()(),c._3(26,0,null,null,1,"button",[["class","button is-primary"]],[[8,"disabled",0]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.uploadMulti()&&r),r},null,null)),(e()(),c._22(-1,null,["\n    Upload Multiple\n  "])),(e()(),c._22(-1,null,["\n"])),(e()(),c._22(-1,null,["\n"]))],function(e,t){e(t,1,0,t.component.currentUpload)},function(e,t){var n=t.component;e(t,13,0,!n.selectedFiles),e(t,26,0,!n.selectedFiles)})}function a(e){return c._24(0,[(e()(),c._3(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n  "])),(e()(),c._3(2,0,null,null,1,"upload-detail",[],null,null,null,r,g)),c._2(3,49152,null,0,h,[d],{upload:[0,"upload"]},null),(e()(),c._22(-1,null,["\n"]))],function(e,t){e(t,3,0,t.context.$implicit)},null)}function s(e){return c._24(0,[(e()(),c._3(0,0,null,null,1,"loading-spinner",[],null,null,null,E.b,E.a)),c._2(1,49152,null,0,b.a,[],null,null)],null,null)}function u(e){return c._24(0,[(e()(),c._3(0,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),c._22(-1,null,["File Uploads"])),(e()(),c._22(-1,null,["\n\n"])),(e()(),c.Y(16777216,null,null,2,null,a)),c._2(4,802816,null,0,m.k,[c.M,c.J,c.q],{ngForOf:[0,"ngForOf"]},null),c._17(131072,m.b,[c.h]),(e()(),c._22(-1,null,["\n\n"])),(e()(),c.Y(16777216,null,null,1,null,s)),c._2(8,16384,null,0,m.l,[c.M,c.J],{ngIf:[0,"ngIf"]},null),(e()(),c._22(-1,null,["\n\n"])),(e()(),c._3(10,0,null,null,0,"hr",[],null,null,null,null,null)),(e()(),c._22(-1,null,["\n\n"])),(e()(),c._3(12,0,null,null,1,"upload-form",[],null,null,null,i,T)),c._2(13,49152,null,0,v,[d],null,null),(e()(),c._22(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,4,0,c._23(t,4,0,c._16(t,5).transform(n.uploads))),e(t,8,0,n.showSpinner)},null)}Object.defineProperty(t,"__esModule",{value:!0});var c=n("LMZF"),l=function(){function e(e){this.upSvc=e,this.showSpinner=!0}return e.prototype.ngOnInit=function(){var e=this;this.uploads=this.upSvc.getUploads(),this.uploads.subscribe(function(){return e.showSpinner=!1})},e}(),p=function(){},h=function(){function e(e){this.upSvc=e}return e.prototype.deleteUpload=function(){this.upSvc.deleteUpload(this.upload)},e}(),_=n("iEW0"),f=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},d=function(){function e(e){this.db=e,this.basePath="uploads"}return e.prototype.getUploads=function(){return this.uploads=this.db.list(this.basePath).snapshotChanges().map(function(e){return e.map(function(e){var t=e.payload.val();return f({$key:e.payload.key},t)})}),this.uploads},e.prototype.deleteUpload=function(e){var t=this;this.deleteFileData(e.$key).then(function(){t.deleteFileStorage(e.name)}).catch(function(e){return console.log(e)})},e.prototype.pushUpload=function(e){var t=this,n=_.storage().ref().child(this.basePath+"/"+e.file.name).put(e.file);n.on(_.storage.TaskEvent.STATE_CHANGED,function(t){var n=t;e.progress=n.bytesTransferred/n.totalBytes*100},function(e){console.log(e)},function(){if(n.snapshot.downloadURL)return e.url=n.snapshot.downloadURL,e.name=e.file.name,void t.saveFileData(e);console.error("No download URL!")})},e.prototype.saveFileData=function(e){this.db.list(this.basePath+"/").push(e)},e.prototype.deleteFileData=function(e){return this.db.list(this.basePath+"/").remove(e)},e.prototype.deleteFileStorage=function(e){_.storage().ref().child(this.basePath+"/"+e).delete()},e}(),g=c._1({encapsulation:0,styles:[[""]],data:{}}),E=n("woi+"),b=n("zX4g"),m=n("Un6q"),y=function(){return function(e){this.createdAt=new Date,this.file=e}}(),v=function(){function e(e){this.upSvc=e}return e.prototype.detectFiles=function(e){this.selectedFiles=e.target.files},e.prototype.uploadSingle=function(){var e=this.selectedFiles;e&&1===e.length?(this.currentUpload=new y(e.item(0)),this.upSvc.pushUpload(this.currentUpload)):console.error("No file found!")},e.prototype.uploadMulti=function(){var e=this,t=this.selectedFiles;t&&0!==t.length?Array.from(t).forEach(function(t){e.currentUpload=new y(t),e.upSvc.pushUpload(e.currentUpload)}):console.error("No Multi Files found!")},e}(),T=c._1({encapsulation:0,styles:[[""]],data:{}}),S=c._1({encapsulation:0,styles:[[""]],data:{}}),N=c.Z("uploads-list",l,function(e){return c._24(0,[(e()(),c._3(0,0,null,null,1,"uploads-list",[],null,null,null,u,S)),c._2(1,114688,null,0,l,[d],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),R=n("13je"),w=n("HAwn"),I=n("T2Au"),A=n("UHIZ");n.d(t,"UploadModuleNgFactory",function(){return O});var O=c._0(p,[],function(e){return c._14([c._15(512,c.j,c.W,[[8,[N]],[3,c.j],c.v]),c._15(4608,m.n,m.m,[c.s,[2,m.r]]),c._15(5120,R.b,R.f,[R.c,R.d]),c._15(5120,w.a,w.c,[R.b]),c._15(4608,d,d,[w.a]),c._15(512,m.c,m.c,[]),c._15(512,I.a,I.a,[]),c._15(512,R.a,R.a,[]),c._15(512,w.b,w.b,[]),c._15(512,A.n,A.n,[[2,A.s],[2,A.k]]),c._15(512,p,p,[]),c._15(1024,A.i,function(){return[[{path:"",component:l}]]},[])])})},usOC:function(e,t,n){"use strict";function r(e){return"storage/"+e}function o(){return new se(ue.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function i(){return new se(ue.CANCELED,"User canceled the upload/download.")}function a(){return new se(ue.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function s(e,t,n){return new se(ue.INVALID_ARGUMENT,"Invalid argument in `"+t+"` at index "+e+": "+n)}function u(){return new se(ue.APP_DELETED,"The Firebase app was deleted.")}function c(e,t){return new se(ue.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function l(e){throw new se(ue.INTERNAL_ERROR,"Internal error: "+e)}function p(e){switch(e){case ce.RAW:case ce.BASE64:case ce.BASE64URL:case ce.DATA_URL:return;default:throw"Expected one of the event types: ["+ce.RAW+", "+ce.BASE64+", "+ce.BASE64URL+", "+ce.DATA_URL+"]."}}function h(e,t){switch(e){case ce.RAW:return new le(_(t));case ce.BASE64:case ce.BASE64URL:return new le(f(e,t));case ce.DATA_URL:return new le(function(e){var t=new pe(e);return t.base64?f(ce.BASE64,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(e){throw c(ce.DATA_URL,"Malformed data URL.")}return _(t)}(t.rest)}(t),function(e){return new pe(e).contentType}(t))}throw o()}function _(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){var o=r,i=e.charCodeAt(++n);t.push(240|(r=65536|(1023&o)<<10|1023&i)>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189);else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function f(e,t){switch(e){case ce.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw c(e,"Invalid character '"+(a=n?"-":"_")+"' found: is it base64url encoded?");break;case ce.BASE64URL:var o=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(o||i){var a=o?"+":"/";throw c(e,"Invalid character '"+a+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(t)}catch(t){throw c(e,"Invalid character found")}for(var u=new Uint8Array(s.length),l=0;l<s.length;l++)u[l]=s.charCodeAt(l);return u}function d(e){switch(e){case _e.RUNNING:case _e.PAUSING:case _e.CANCELING:return fe.RUNNING;case _e.PAUSED:return fe.PAUSED;case _e.SUCCESS:return fe.SUCCESS;case _e.CANCELED:return fe.CANCELED;case _e.ERROR:default:return fe.ERROR}}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){for(var n in e)g(e,n)&&t(n,e[n])}function b(e){if(null==e)return{};var t={};return E(e,function(e,n){t[e]=n}),t}function m(e){return new Promise(e)}function y(e){return Promise.resolve(e)}function v(e){return null!=e}function T(e){return void 0!==e}function S(e){return"function"==typeof e}function N(e){return"object"==typeof e}function R(e){return N(e)&&null!==e}function w(e){return"string"==typeof e||e instanceof String}function I(e){return A()&&e instanceof Blob}function A(){return"undefined"!=typeof Blob}function O(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function D(e){return te+ne+e}function U(e){return te+re+e}function k(e){var t=encodeURIComponent,n="?";return E(e,function(e,r){var o=t(e)+"="+t(r);n=n+o+"&"}),n=n.slice(0,-1)}function P(e,t){for(var n={},r=t.length,o=0;o<r;o++){var i=t[o];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}function C(e){if(!e||!N(e))throw"Expected Metadata object.";for(var t in e){var n=e[t];if("customMetadata"===t){if(!N(n))throw"Expected object for 'customMetadata' mapping."}else if(R(n))throw"Mapping for '"+t+"' cannot be an object."}}function L(e,t,n){for(var r=t.length,o=t.length,i=0;i<t.length;i++)if(t[i].optional){r=i;break}if(!(r<=n.length&&n.length<=o))throw function(t,r,o,i){var a,s;return t===r?(a=t,s=1===t?"argument":"arguments"):(a="between "+t+" and "+r,s="arguments"),new se(ue.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+e+"`: Expected "+a+" "+s+", received "+n.length+".")}(r,o);for(i=0;i<n.length;i++)try{t[i].validator(n[i])}catch(t){throw t instanceof Error?s(i,e,t.message):s(i,e,t)}}function F(e,t){function n(e){if(!w(e))throw"Expected string."}var r;return r=e?function(e,t){return function(n){e(n),t(n)}}(n,e):n,new ve(r,t)}function B(e){return new ve(C,e)}function M(){return new ve(function(e){if(!(function(e){return"number"==typeof e||e instanceof Number}(e)&&e>=0))throw"Expected a number 0 or greater."})}function W(e,t){return new ve(function(t){if(!(null===t||v(t)&&t instanceof Object))throw"Expected an Object.";void 0!==e&&null!==e&&e(t)},t)}function x(e){return new ve(function(e){if(null!==e&&!S(e))throw"Expected a Function."},e)}function K(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function j(e,t){return-1!==e.indexOf(t)}function G(e){if(!e)throw o()}function V(e,t){return function(n,r){var o=function(e,t,n){var o=function(e){var t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return N(e)&&!Array.isArray(e)}(t)?t:null}(r);return null===o?null:function(e,t,n){var r={};r.type="file";for(var o=n.length,i=0;i<o;i++){var a=n[i];r[a.local]=a.xform(r,t[a.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=new be(e.bucket,e.fullPath);return t.makeStorageReference(n)}})}(r,e),r}(e,o,n)}(e,0,t);return G(null!==o),o}}function H(e){return function(t,n){var r;return(r=401===t.getStatus()?new se(ue.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?new se(ue.QUOTA_EXCEEDED,"Quota for bucket '"+e.bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/."):403===t.getStatus()?new se(ue.UNAUTHORIZED,"User does not have permission to access '"+e.path+"'."):n).setServerResponseProp(n.serverResponseProp()),r}}function q(e){var t=H(e);return function(n,r){var o=t(n,r);return 404===n.getStatus()&&(o=new se(ue.OBJECT_NOT_FOUND,"Object '"+e.path+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function Y(e,t,n){var r=D(t.fullServerUrl()),o=e.maxOperationRetryTime(),i=new Se(r,"GET",V(e,n),o);return i.errorHandler=q(t),i}function z(e,t,n){var r=b(n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return t&&t.type()||"application/octet-stream"}(0,t)),r}function X(e,t){var n;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){G(!1)}return G(j(t||["active"],n)),n}function Z(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];y(!0).then(function(){e.apply(null,t)})}}function J(e,t,n){var r=k(e.urlParams),o=e.url+r,i=b(e.headers);return function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(i,t),function(e){e["X-Firebase-Storage-Version"]="webjs/"+(void 0!==ee.default?ee.default.SDK_VERSION:"AppManager")}(i),new ke(o,e.method,i,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n)}function $(e,t,n){return new Ce(e,new Ee,n)}function Q(e){e.INTERNAL.registerService(Fe,$,{TaskState:fe,TaskEvent:he,StringFormat:ce,Storage:Ce,Reference:Ae},void 0,!0)}Object.defineProperty(t,"__esModule",{value:!0});var ee=n("XtH8"),te="https://firebasestorage.googleapis.com",ne="/v0",re="/v0",oe=12e4,ie=6e4,ae=-9007199254740991,se=function(){function e(e,t){this.code_=r(e),this.message_="Firebase Storage: "+t,this.serverResponse_=null,this.name_="FirebaseError"}return e.prototype.codeProp=function(){return this.code},e.prototype.codeEquals=function(e){return r(e)===this.codeProp()},e.prototype.serverResponseProp=function(){return this.serverResponse_},e.prototype.setServerResponseProp=function(e){this.serverResponse_=e},Object.defineProperty(e.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),e}(),ue={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},ce={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},le=function(e,t){this.data=e,this.contentType=t||null},pe=function(){return function(e){this.base64=!1,this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw c(ce.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=t[1]||null;null!=n&&(this.base64=function(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}(),he={STATE_CHANGED:"state_changed"},_e={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},fe={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"},de=function(){var e={};return e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT",e}(),ge=function(){function e(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=de.NO_ERROR,this.sendPromise_=m(function(t,n){e.xhr_.addEventListener("abort",function(n){e.errorCode_=de.ABORT,t(e)}),e.xhr_.addEventListener("error",function(n){e.errorCode_=de.NETWORK_ERROR,t(e)}),e.xhr_.addEventListener("load",function(n){t(e)})})}return e.prototype.send=function(e,t,n,r){var o=this;if(this.sent_)throw l("cannot .send() more than once");return this.sent_=!0,this.xhr_.open(t,e,!0),v(r)&&E(r,function(e,t){o.xhr_.setRequestHeader(e,t.toString())}),v(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},e.prototype.getErrorCode=function(){if(!this.sent_)throw l("cannot .getErrorCode() before sending");return this.errorCode_},e.prototype.getStatus=function(){if(!this.sent_)throw l("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},e.prototype.getResponseText=function(){if(!this.sent_)throw l("cannot .getResponseText() before sending");return this.xhr_.responseText},e.prototype.abort=function(){this.xhr_.abort()},e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},e.prototype.addUploadProgressListener=function(e){v(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",e)},e.prototype.removeUploadProgressListener=function(e){v(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",e)},e}(),Ee=function(){function e(){}return e.prototype.createXhrIo=function(){return new ge},e}(),be=function(){function e(e,t){this.bucket=e,this.path_=t}return Object.defineProperty(e.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),e.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},e.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},e.makeFromBucketSpec=function(t){var n;try{n=e.makeFromUrl(t)}catch(n){return new e(t,"")}if(""===n.path)return n;throw new se(ue.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")},e.makeFromUrl=function(t){for(var n=null,r=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(e){e.path_=decodeURIComponent(e.path)}}],o=0;o<r.length;o++){var i=r[o],a=i.regex.exec(t);if(a){var s=a[i.indices.path];s||(s=""),n=new e(a[i.indices.bucket],s),i.postModify(n);break}}if(null==n)throw function(e){return new se(ue.INVALID_URL,"Invalid URL '"+e+"'.")}(t);return n},e}(),me=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||function(e,t){return t}},ye=null,ve=function(){return function(e,t){var n=this;this.validator=function(t){n.optional&&!T(t)||e(t)},this.optional=!!t}}(),Te=function(){function e(e,t){var n=0,r="";I(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}return e.prototype.size=function(){return this.size_},e.prototype.type=function(){return this.type_},e.prototype.slice=function(t,n){if(I(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}return new e(new Uint8Array(this.data_.buffer,t,n-t),!0)},e.getBlob=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(A()){var r=t.map(function(t){return t instanceof e?t.data_:t});return new e(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=K();if(void 0!==n){for(var r=new n,o=0;o<e.length;o++)r.append(e[o]);return r.getBlob()}if(A())return new Blob(e);throw Error("This browser doesn't seem to support creating Blobs")}.apply(null,r))}var o=t.map(function(e){return w(e)?h(ce.RAW,e).data:e.data_}),i=0;o.forEach(function(e){i+=e.byteLength});var a=new Uint8Array(i),s=0;return o.forEach(function(e){for(var t=0;t<e.length;t++)a[s++]=e[t]}),new e(a,!0)},e.prototype.uploadData=function(){return this.data_},e}(),Se=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]},Ne=function(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null},Re=function(){return function(e,t,n){if(S(e)||v(t)||v(n))this.next=e,this.error=t||null,this.complete=n||null;else{var r=e;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}}(),we=function(){function e(e,t,n,r,o,i){this.bytesTransferred=e,this.totalBytes=t,this.state=n,this.metadata=r,this.task=o,this.ref=i}return Object.defineProperty(e.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var e=this.metadata.downloadURLs;return null!=e&&null!=e[0]?e[0]:null}return null},enumerable:!0,configurable:!0}),e}(),Ie=function(){function e(e,t,n,r,o,i){void 0===i&&(i=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=e,this.authWrapper_=t,this.location_=n,this.blob_=o,this.metadata_=i,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=_e.RUNNING,this.errorHandler_=function(e){a.request_=null,a.chunkMultiplier_=1,e.codeEquals(ue.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=e,a.transition_(_e.ERROR))},this.metadataErrorHandler_=function(e){a.request_=null,e.codeEquals(ue.CANCELED)?a.completeTransitions_():(a.error_=e,a.transition_(_e.ERROR))},this.promise_=m(function(e,t){a.resolve_=e,a.reject_=t,a.start_()}),this.promise_.then(null,function(){})}return e.prototype.makeProgressCallback_=function(){var e=this,t=this.transferred_;return function(n,r){e.updateProgress_(t+n)}},e.prototype.shouldDoResumable_=function(e){return e.size()>262144},e.prototype.start_=function(){this.state_===_e.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},e.prototype.resolveToken_=function(e){var t=this;this.authWrapper_.getAuthToken().then(function(n){switch(t.state_){case _e.RUNNING:e(n);break;case _e.CANCELING:t.transition_(_e.CANCELED);break;case _e.PAUSING:t.transition_(_e.PAUSED)}})},e.prototype.createResumable_=function(){var e=this;this.resolveToken_(function(t){var n=function(e,t,n,r,o){var i=t.bucketOnlyServerUrl(),a=z(t,r,o),s={name:a.fullPath},u=U(i),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=P(a,n),p=e.maxUploadRetryTime(),h=new Se(u,"POST",function(e,t){X(e);var n;try{n=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){G(!1)}return G(w(n)),n},p);return h.urlParams=s,h.headers=c,h.body=l,h.errorHandler=H(t),h}(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.uploadUrl_=t,e.needToFetchStatus_=!1,e.completeTransitions_()},e.errorHandler_)})},e.prototype.fetchStatus_=function(){var e=this,t=this.uploadUrl_;this.resolveToken_(function(n){var r=function(t,n,r,o){var i=e.authWrapper_.maxUploadRetryTime(),a=new Se(r,"POST",function(e,t){var n,r=X(e,["active","final"]);try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){G(!1)}var i=parseInt(n,10);return G(!isNaN(i)),new Ne(i,o.size(),"final"===r)},i);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=H(n),a}(0,e.location_,t,e.blob_),o=e.authWrapper_.makeRequest(r,n);e.request_=o,o.getPromise().then(function(t){t=t,e.request_=null,e.updateProgress_(t.current),e.needToFetchStatus_=!1,t.finalized&&(e.needToFetchMetadata_=!0),e.completeTransitions_()},e.errorHandler_)})},e.prototype.continueUpload_=function(){var e=this,t=262144*this.chunkMultiplier_,n=new Ne(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(o){var i;try{i=function(e,t,n,r,o,i,s,u){var c=new Ne(0,0);if(s?(c.current=s.current,c.total=s.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new se(ue.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var l=c.total-c.current,p=l;o>0&&(p=Math.min(p,o));var h=c.current,_={"X-Goog-Upload-Command":p===l?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},f=r.slice(h,h+p);if(null===f)throw a();var d=t.maxUploadRetryTime(),g=new Se(n,"POST",function(e,n){var o,a=X(e,["active","final"]),s=c.current+p,u=r.size();return o="final"===a?V(t,i)(e,n):null,new Ne(s,u,"final"===a,o)},d);return g.headers=_,g.body=f.uploadData(),g.progressCallback=u||null,g.errorHandler=H(e),g}(e.location_,e.authWrapper_,r,e.blob_,t,e.mappings_,n,e.makeProgressCallback_())}catch(t){return e.error_=t,void e.transition_(_e.ERROR)}var s=e.authWrapper_.makeRequest(i,o);e.request_=s,s.getPromise().then(function(t){e.increaseMultiplier_(),e.request_=null,e.updateProgress_(t.current),t.finalized?(e.metadata_=t.metadata,e.transition_(_e.SUCCESS)):e.completeTransitions_()},e.errorHandler_)})},e.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},e.prototype.fetchMetadata_=function(){var e=this;this.resolveToken_(function(t){var n=Y(e.authWrapper_,e.location_,e.mappings_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.metadata_=t,e.transition_(_e.SUCCESS)},e.metadataErrorHandler_)})},e.prototype.oneShotUpload_=function(){var e=this;this.resolveToken_(function(t){var n=function(e,t,n,r,o){var i=t.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},u=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();s["Content-Type"]="multipart/related; boundary="+u;var c=z(t,r,o),l=P(c,n),p=Te.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+l+"\r\n--"+u+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===p)throw a();var h={name:c.fullPath},_=U(i),f=e.maxUploadRetryTime(),d=new Se(_,"POST",V(e,n),f);return d.urlParams=h,d.headers=s,d.body=p.uploadData(),d.errorHandler=H(t),d}(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.metadata_=t,e.updateProgress_(e.blob_.size()),e.transition_(_e.SUCCESS)},e.errorHandler_)})},e.prototype.updateProgress_=function(e){var t=this.transferred_;this.transferred_=e,this.transferred_!==t&&this.notifyObservers_()},e.prototype.transition_=function(e){if(this.state_!==e)switch(e){case _e.CANCELING:case _e.PAUSING:this.state_=e,null!==this.request_&&this.request_.cancel();break;case _e.RUNNING:var t=this.state_===_e.PAUSED;this.state_=e,t&&(this.notifyObservers_(),this.start_());break;case _e.PAUSED:this.state_=e,this.notifyObservers_();break;case _e.CANCELED:this.error_=i(),this.state_=e,this.notifyObservers_();break;case _e.ERROR:case _e.SUCCESS:this.state_=e,this.notifyObservers_()}},e.prototype.completeTransitions_=function(){switch(this.state_){case _e.PAUSING:this.transition_(_e.PAUSED);break;case _e.CANCELING:this.transition_(_e.CANCELED);break;case _e.RUNNING:this.start_()}},Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=d(this.state_);return new we(this.transferred_,this.blob_.size(),e,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t,n,r){function o(e){try{return void s(e)}catch(e){}try{if(u(e),!(T(e.next)||T(e.error)||T(e.complete)))throw"";return}catch(e){throw a}}function i(e){return function(t,n,o){null!==e&&L("on",e,arguments);var i=new Re(t,n,r);return c.addObserver_(i),function(){c.removeObserver_(i)}}}void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var a="Expected a function or an Object with one of `next`, `error`, `complete` properties.",s=x(!0).validator,u=W(null,!0).validator;L("on",[F(function(t){if(e!==he.STATE_CHANGED)throw"Expected one of the event types: ["+he.STATE_CHANGED+"]."}),W(o,!0),x(!0),x(!0)],arguments);var c=this,l=[W(function(e){if(null===e)throw a;o(e)}),x(!0),x(!0)];return T(t)||T(n)||T(r)?i(null)(t,n,r):i(l)},e.prototype.then=function(e,t){return this.promise_.then(e,t)},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.addObserver_=function(e){this.observers_.push(e),this.notifyObserver_(e)},e.prototype.removeObserver_=function(e){!function(t,n){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}(this.observers_)},e.prototype.notifyObservers_=function(){var e=this;this.finishPromise_(),function(e){return Array.prototype.slice.call(e)}(this.observers_).forEach(function(t){e.notifyObserver_(t)})},e.prototype.finishPromise_=function(){if(null!==this.resolve_){var e=!0;switch(d(this.state_)){case fe.SUCCESS:Z(this.resolve_.bind(null,this.snapshot))();break;case fe.CANCELED:case fe.ERROR:Z(this.reject_.bind(null,this.error_))();break;default:e=!1}e&&(this.resolve_=null,this.reject_=null)}},e.prototype.notifyObserver_=function(e){switch(d(this.state_)){case fe.RUNNING:case fe.PAUSED:null!==e.next&&Z(e.next.bind(e,this.snapshot))();break;case fe.SUCCESS:null!==e.complete&&Z(e.complete.bind(e))();break;case fe.CANCELED:case fe.ERROR:null!==e.error&&Z(e.error.bind(e,this.error_))();break;default:null!==e.error&&Z(e.error.bind(e,this.error_))()}},e.prototype.resume=function(){L("resume",[],arguments);var e=this.state_===_e.PAUSED||this.state_===_e.PAUSING;return e&&this.transition_(_e.RUNNING),e},e.prototype.pause=function(){L("pause",[],arguments);var e=this.state_===_e.RUNNING;return e&&this.transition_(_e.PAUSING),e},e.prototype.cancel=function(){L("cancel",[],arguments);var e=this.state_===_e.RUNNING||this.state_===_e.PAUSING;return e&&this.transition_(_e.CANCELING),e},e}(),Ae=function(){function e(e,t){this.authWrapper=e,this.location=t instanceof be?t:be.makeFromUrl(t)}return e.prototype.toString=function(){return L("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},e.prototype.newRef=function(t,n){return new e(t,n)},e.prototype.mappings=function(){return function(){if(ye)return ye;var e=[];e.push(new me("bucket")),e.push(new me("generation")),e.push(new me("metageneration")),e.push(new me("name","fullPath",!0));var t=new me("name");t.xform=function(e,t){return function(e){return!w(e)||e.length<2?e:(e=e,O(e))}(t)},e.push(t);var n=new me("size");return n.xform=function(e,t){return v(t)?+t:t},e.push(n),e.push(new me("timeCreated")),e.push(new me("updated")),e.push(new me("md5Hash",null,!0)),e.push(new me("cacheControl",null,!0)),e.push(new me("contentDisposition",null,!0)),e.push(new me("contentEncoding",null,!0)),e.push(new me("contentLanguage",null,!0)),e.push(new me("contentType",null,!0)),e.push(new me("metadata","customMetadata",!0)),e.push(new me("downloadTokens","downloadURLs",!1,function(e,t){if(!(w(t)&&t.length>0))return[];var n=encodeURIComponent;return t.split(",").map(function(t){var r=e.fullPath;return function(e){return"https://firebasestorage.googleapis.com"+ne+e}("/b/"+n(e.bucket)+"/o/"+n(r))+k({alt:"media",token:t})})})),ye=e}()},e.prototype.child=function(e){L("child",[F()],arguments);var t=function(e,t){var n=t.split("/").filter(function(e){return e.length>0}).join("/");return 0===e.length?n:e+"/"+n}(this.location.path,e),n=new be(this.location.bucket,t);return this.newRef(this.authWrapper,n)},Object.defineProperty(e.prototype,"parent",{get:function(){var e=function(e){if(0==e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this.location.path);if(null===e)return null;var t=new be(this.location.bucket,e);return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){var e=new be(this.location.bucket,"");return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return O(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),e.prototype.put=function(e,t){return void 0===t&&(t=null),L("put",[new ve(function(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||A()&&e instanceof Blob))throw"Expected Blob or File."}),B(!0)],arguments),this.throwIfRoot_("put"),new Ie(this,this.authWrapper,this.location,this.mappings(),new Te(e),t)},e.prototype.putString=function(e,t,n){void 0===t&&(t=ce.RAW),L("putString",[F(),F(p,!0),B(!0)],arguments),this.throwIfRoot_("putString");var r=h(t,e),o=b(n);return!v(o.contentType)&&v(r.contentType)&&(o.contentType=r.contentType),new Ie(this,this.authWrapper,this.location,this.mappings(),new Te(r.data,!0),o)},e.prototype.delete=function(){L("delete",[],arguments),this.throwIfRoot_("delete");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=function(e,t){var n=D(t.fullServerUrl()),r=e.maxOperationRetryTime(),o=new Se(n,"DELETE",function(e,t){},r);return o.successCodes=[200,204],o.errorHandler=q(t),o}(e.authWrapper,e.location);return e.authWrapper.makeRequest(n,t).getPromise()})},e.prototype.getMetadata=function(){L("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=Y(e.authWrapper,e.location,e.mappings());return e.authWrapper.makeRequest(n,t).getPromise()})},e.prototype.updateMetadata=function(e){L("updateMetadata",[B()],arguments),this.throwIfRoot_("updateMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(n){var r=function(e,t,n,r){var o=D(t.fullServerUrl()),i=P(n,r),a=e.maxOperationRetryTime(),s=new Se(o,"PATCH",V(e,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=i,s.errorHandler=q(t),s}(t.authWrapper,t.location,e,t.mappings());return t.authWrapper.makeRequest(r,n).getPromise()})},e.prototype.getDownloadURL=function(){return L("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(e){var t=e.downloadURLs[0];if(v(t))return t;throw new se(ue.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")})},e.prototype.throwIfRoot_=function(e){if(""===this.location.path)throw function(e){return new se(ue.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)},e}(),Oe=function(){function e(e){this.promise_=function(e){return Promise.reject(e)}(e)}return e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){void 0===e&&(e=!1)},e}(),De=function(){function e(){this.map_={},this.id_=ae}return e.prototype.addRequest=function(e){function t(){delete r.map_[n]}var n=this.id_;this.id_++,this.map_[n]=e;var r=this;e.getPromise().then(t,t)},e.prototype.clear=function(){E(this.map_,function(e,t){t&&t.cancel(!0)}),this.map_={}},e}(),Ue=function(){function e(t,n,r,o,i){if(this.bucket_=null,this.deleted_=!1,this.app_=t,null!==this.app_){var a=this.app_.options;v(a)&&(this.bucket_=e.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=i,this.service_=o,this.maxOperationRetryTime_=oe,this.maxUploadRetryTime_=ie,this.requestMap_=new De}return e.extractBucket_=function(e){var t=e.storageBucket||null;return null==t?null:be.makeFromBucketSpec(t).bucket},e.prototype.getAuthToken=function(){return null!==this.app_&&v(this.app_.INTERNAL)&&v(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(e){return null!==e?e.accessToken:null},function(e){return null}):y(null)},e.prototype.bucket=function(){if(this.deleted_)throw u();return this.bucket_},e.prototype.service=function(){return this.service_},e.prototype.makeStorageReference=function(e){return this.storageRefMaker_(this,e)},e.prototype.makeRequest=function(e,t){if(this.deleted_)return new Oe(u());var n=this.requestMaker_(e,t,this.pool_);return this.requestMap_.addRequest(n),n},e.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},e.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},e.prototype.setMaxUploadRetryTime=function(e){this.maxUploadRetryTime_=e},e.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},e.prototype.setMaxOperationRetryTime=function(e){this.maxOperationRetryTime_=e},e}(),ke=function(){function e(e,t,n,r,o,i,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=o.slice(),this.additionalRetryCodes_=i.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var p=this;this.promise_=m(function(e,t){p.resolve_=e,p.reject_=t,p.start_()})}return e.prototype.start_=function(){function e(e,n){var r=t.resolve_,a=t.reject_,s=n.xhr;if(n.wasSuccessCode)try{var c=t.callback_(s,s.getResponseText());T(c)?r(c):r()}catch(e){a(e)}else if(null!==s)(l=o()).setServerResponseProp(s.getResponseText()),a(t.errorCallback_?t.errorCallback_(s,l):l);else if(n.canceled)a(l=t.appDelete_?u():i());else{var l=new se(ue.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.");a(l)}}var t=this;this.canceled_?e(0,new Pe(!1,null,!0)):this.backoffId_=function(e,t,n){function r(){return 2===p}function o(){h||(h=!0,t.apply(null,arguments))}function i(t){c=setTimeout(function(){c=null,e(a,r())},t)}function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!h)if(e)o.apply(null,arguments);else if(r()||l)o.apply(null,arguments);else{u<64&&(u*=2);var a;1===p?(p=2,a=0):a=1e3*(u+Math.random()),i(a)}}function s(e){_||(_=!0,h||(null!==c?(e||(p=2),clearTimeout(c),i(0)):e||(p=1)))}var u=1,c=null,l=!1,p=0,h=!1,_=!1;return i(0),setTimeout(function(){l=!0,s(!0)},n),s}(function(e,n){function r(e){null!==t.progressCallback_&&t.progressCallback_(e.loaded,e.lengthComputable?e.total:-1)}if(n)e(!1,new Pe(!1,null,!0));else{var o=t.pool_.createXhrIo();t.pendingXhr_=o,null!==t.progressCallback_&&o.addUploadProgressListener(r),o.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(r),t.pendingXhr_=null;var o=(n=n).getErrorCode()===de.NO_ERROR,i=n.getStatus();if(o&&!t.isRetryStatusCode_(i)){var a=j(t.successCodes_,i);e(!0,new Pe(a,n))}else{var s=n.getErrorCode()===de.ABORT;e(!1,new Pe(!1,null,s))}})}},e,this.timeout_)},e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},e.prototype.isRetryStatusCode_=function(e){var t=e>=500&&e<600,n=j([408,429],e),r=j(this.additionalRetryCodes_,e);return t||n||r},e}(),Pe=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n},Ce=function(){function e(e,t,n){if(this.bucket_=null,this.authWrapper_=new Ue(e,function(e,t){return new Ae(e,t)},J,this,t),this.app_=e,null!=n)this.bucket_=be.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new be(r,""))}this.internals_=new Le(this)}return e.prototype.ref=function(e){if(L("ref",[F(function(e){if(/^[A-Za-z]+:\/\//.test(e))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var t=new Ae(this.authWrapper_,this.bucket_);return null!=e?t.child(e):t},e.prototype.refFromURL=function(e){return L("refFromURL",[F(function(e){if(!/^[A-Za-z]+:\/\//.test(e))throw"Expected full URL but got a child path, use ref instead.";try{be.makeFromUrl(e)}catch(e){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Ae(this.authWrapper_,e)},Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxUploadRetryTime=function(e){L("setMaxUploadRetryTime",[M()],arguments),this.authWrapper_.setMaxUploadRetryTime(e)},Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxOperationRetryTime=function(e){L("setMaxOperationRetryTime",[M()],arguments),this.authWrapper_.setMaxOperationRetryTime(e)},Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),e}(),Le=function(){function e(e){this.service_=e}return e.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),y(void 0)},e}();t.registerStorage=Q;var Fe="storage";Q(ee.default)}});